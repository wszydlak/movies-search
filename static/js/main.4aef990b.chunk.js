(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{15:function(e,t,a){e.exports={list:"movies_list__i04n0","no-results":"movies_no-results__3WBe2",element:"movies_element__FOPWu",element_hidden:"movies_element_hidden__14YJv",element__link:"movies_element__link__3p-50",element__image:"movies_element__image__22ofU","element__vote-wrapper":"movies_element__vote-wrapper__1bvED",element__vote:"movies_element__vote__1rbbf",element__title:"movies_element__title__3l4GA"}},18:function(e,t,a){e.exports={header:"header_header__3fn4i",logo:"header_logo__14tHM",logo__image:"header_logo__image__cVPkB",form:"header_form__3Ry9u",form__input:"header_form__input__WncE_",form__select:"header_form__select__1eZjZ"}},32:function(e,t,a){e.exports={image:"progressive-image_image__Ar7dz",image_progress:"progressive-image_image_progress__9vKrS"}},45:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n,r=a(1),c=a.n(r),s=a(23),o=a.n(s),i=(a(45),a(17)),u=a(39),l=a(16),m=a(27),p=a(14),_=a(35),j="MOVIES_FETCH",b="MOVIES_RECEIVED",v=function(e){return{type:"MOVIES_SEARCH",phrase:e.phrase,year:e.year}},O=function(e,t){return{type:b,search:t,movies:e}},f=function(e,t){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,n=arguments.length>1?arguments[1]:void 0;return Object.prototype.hasOwnProperty.call(t,n.type)?t[n.type](a,n):a}},h=Object(_.parse)(window.location.search),d={isLoading:!1,phrase:h.phrase||void 0,year:h.year||void 0,movies:[],page:0,pages:0,total:0},g=f(d,(n={},Object(l.a)(n,j,(function(e){var t=e.movies,a=e.total;return t.length<a?Object(p.a)(Object(p.a)({},e),{},{isLoading:!0}):e})),Object(l.a)(n,"MOVIES_RESET",(function(){return Object(p.a)(Object(p.a)({},d),{},{phrase:void 0,year:void 0})})),Object(l.a)(n,b,(function(e,t){var a=t.movies,n=a.page,r=a.pages,c=a.total,s=a.movies,o=t.search,i=o.phrase,u=o.year;return Object(p.a)(Object(p.a)({},e),{},{phrase:i,year:u,page:n,pages:r,total:c,movies:1===n?Object(m.a)(s):[].concat(Object(m.a)(e.movies),Object(m.a)(s)),isLoading:!1})})),n)),x=Object(i.b)({movies:g}),w=a(7),y=a.n(w),E=a(10),N=a(36),S={mapResults:function(e){var t=e.results,a=e.total_results;return{page:e.page,pages:e.total_pages,total:a,movies:t.map(S.mapResult)}},mapResult:function(e){var t=e.id,a=e.overview,n=e.poster_path,r=e.release_date,c=e.title,s=e.vote_average;return{id:t,date:r,image:n?{small:"https://image.tmdb.org/t/p/w92".concat(n),medium:"https://image.tmdb.org/t/p/w300".concat(n),large:"https://image.tmdb.org/t/p/w780".concat(n)}:void 0,title:c,overview:a,vote:s}},prepareUrl:function(e){var t="api_key=03c93abb1975c0c02a167e1b3e8b63d4&page=".concat(e.page,"&query=").concat(e.query);return e.year&&(t="".concat(t,"&year=").concat(e.year)),"".concat("https://api.themoviedb.org/3","/search/movie?").concat(t)}},k=function(e,t){return Object(N.a)(y.a.mark((function a(){var n,r,c,s;return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.phrase,r=t.year,a.next=3,fetch(S.prepareUrl({page:e,query:n,year:r}));case 3:return c=a.sent,a.next=6,c.json();case 6:return s=a.sent,a.abrupt("return",S.mapResults(s));case 8:case"end":return a.stop()}}),a)})))()},R=y.a.mark(C),I=y.a.mark(T),M=y.a.mark(D),V=y.a.mark(H),L=y.a.mark(A);function C(e,t){var a;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(E.b)(k,e,t);case 2:return a=n.sent,n.next=5,Object(E.d)(O(a,t));case 5:case"end":return n.stop()}}),R)}function T(){var e,t,a,n;return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(E.e)((function(e){var t=e.movies;return{phrase:t.phrase,year:t.year}}));case 2:if(e=r.sent,t=e.phrase,a=e.year,t){r.next=10;break}return r.next=8,Object(E.d)({type:"MOVIES_RESET"});case 8:r.next=19;break;case 10:return r.next=12,Object(E.e)((function(e){var t=e.movies,a=t.total;return t.movies.length<a}));case 12:if(!r.sent){r.next=19;break}return r.next=16,Object(E.e)((function(e){return e.movies.page}));case 16:return n=r.sent,r.next=19,Object(E.b)(C,n+1,{phrase:t,year:a});case 19:case"end":return r.stop()}}),I)}function D(e){var t,a;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.phrase,a=e.year,t){n.next=6;break}return n.next=4,Object(E.d)({type:"MOVIES_RESET"});case 4:n.next=8;break;case 6:return n.next=8,Object(E.b)(C,1,{phrase:t,year:a});case 8:case"end":return n.stop()}}),M)}function H(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.f)(j,T);case 2:case"end":return e.stop()}}),V)}function A(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.c)(500,"MOVIES_SEARCH",D);case 2:case"end":return e.stop()}}),L)}var F=y.a.mark(P);function P(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.a)([H(),A()]);case 2:case"end":return e.stop()}}),F)}var U=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.c,q=Object(u.a)(),B=Object(i.d)(x,U(Object(i.a)(q)));q.run(P);var J=B,W=a(9),Y=a(38),X=a(6),Z=a(22),z=a.p+"static/media/logo.58c03d10.png",G=a(18),K=a.n(G),Q=a(3),$=(new Date).getFullYear(),ee=Array.from({length:$-1950+1},(function(e,t){return 1950+t})).reverse(),te=function(e){var t=e.onSearch,a=e.phrase,n=e.year,c=Object(r.useState)(a),s=Object(Z.a)(c,2),o=s[0],i=s[1],u=Object(r.useState)(n),l=Object(Z.a)(u,2),m=l[0],p=l[1];return Object(r.useEffect)((function(){void 0!==o&&t(o,m||void 0)}),[t,o,m]),Object(Q.jsxs)("header",{className:K.a.header,children:[Object(Q.jsxs)("div",{className:K.a.logo,children:[Object(Q.jsx)("img",{className:K.a.logo__image,alt:"Logo",src:z}),"Movies Search"]}),Object(Q.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},className:K.a.form,children:[Object(Q.jsx)("input",{className:K.a.form__input,autoFocus:!0,value:o,placeholder:"Search",onChange:function(e){return i(e.target.value)}}),!!o&&Object(Q.jsxs)("select",{value:m,onChange:function(e){return p(e.target.value)},className:K.a.form__select,placeholder:"Select year",children:[Object(Q.jsx)("option",{value:"",children:"Select Year"}),ee.map((function(e){return Object(Q.jsx)("option",{value:e,children:e},"search-year-option-".concat(e))})),Object(Q.jsx)("option",{})]})]})]})},ae=c.a.memo(te),ne=Object(X.e)((function(e){var t=e.history,a=Object(W.c)((function(e){return e.movies.phrase})),n=Object(W.c)((function(e){return e.movies.year})),c=Object(W.b)(),s=Object(r.useCallback)((function(e,a){c(v({phrase:e,year:a})),e?t.push("/search?phrase=".concat(e).concat(a?"&year=".concat(a):"")):t.push("/")}),[c,t]);return Object(Q.jsx)(ae,{year:n,phrase:a,onSearch:s})})),re=c.a.memo(ne),ce=a.p+"static/media/no-image.7ecc4230.png",se=a(40),oe=a(37),ie=a.n(oe),ue=a(32),le=a.n(ue),me=["src","preview","className","alt"],pe=function(e){var t=e.src,a=e.preview,n=e.className,c=e.alt,s=Object(se.a)(e,me),o=Object(r.useState)(!1),i=Object(Z.a)(o,2),u=i[0],m=i[1],_=new Image;return _.onload=function(){return m((function(e){return!1===e||e}))},_.src=t,Object(r.useEffect)((function(){m((function(e){return!0!==e&&e}))}),[t]),Object(Q.jsx)("img",Object(p.a)({src:u?t:a,className:ie()(n,le.a.image,Object(l.a)({},le.a.image_progress,!u)),alt:c},s))},_e=c.a.memo(pe),je=a(15),be=a.n(je),ve=function(e){e.id;var t=e.title,a=e.image,n=e.vote;return Object(Q.jsx)("li",{className:be.a.element,children:Object(Q.jsxs)("div",{className:be.a.element__link,children:[Object(Q.jsx)(_e,{className:be.a.element__image,alt:t,preview:a?a.small:ce,src:a?a.medium:ce,onError:function(e){e.target.src=ce}}),Object(Q.jsx)("span",{className:be.a["element__vote-wrapper"],children:Object(Q.jsx)("span",{className:be.a.element__vote,children:n})}),Object(Q.jsx)("span",{className:be.a.element__title,children:t})]})})},Oe=function(e){var t=e.movies,a=Object(W.c)((function(e){return e.movies.isLoading}));return t.length?Object(Q.jsx)("ul",{className:be.a.list,children:t.map((function(e){return Object(Q.jsx)(ve,Object(p.a)({},e),e.id)}))}):a?null:Object(Q.jsx)("div",{className:be.a["no-results"],children:"No movies found"})},fe=c.a.memo(Oe),he=function(e){e.location;var t=Object(W.c)((function(e){return e.movies})),a=t.movies,n=t.page,r=t.phrase,c=t.year,s=Object(W.b)();return 0===n&&r&&s(v({phrase:r,year:c})),Object(Q.jsx)(fe,{movies:a})},de=c.a.memo(he),ge=function(e){return e.show?Object(Q.jsxs)("div",{className:"spinner",children:[Object(Q.jsx)("span",{className:"spinner__line1"}),Object(Q.jsx)("span",{className:"spinner__line2"}),Object(Q.jsx)("span",{className:"spinner__line3"}),Object(Q.jsx)("span",{className:"spinner__line4"}),Object(Q.jsx)("span",{className:"spinner__line5"})]}):null},xe=c.a.memo(ge),we=function(){var e=Object(W.c)((function(e){return e.movies.isLoading})),t=Object(W.c)((function(e){var t=e.movies,a=t.total;return t.movies.length<a})),a=Object(W.b)();return Object(r.useEffect)((function(){if(!e){var n=function(e){window.removeEventListener("scroll",e)},r=function e(){var r=document.documentElement;window.innerHeight+r.scrollTop>=r.offsetHeight-50&&(a({type:j}),t&&n(e))};return window.addEventListener("scroll",r),function(){n(r)}}}),[a,t,e]),Object(Q.jsxs)("section",{children:[Object(Q.jsx)(X.a,{path:"/search",component:de}),Object(Q.jsx)(xe,{show:e})]})},ye=c.a.memo(we),Ee=function(){return Object(Q.jsx)(W.a,{store:J,children:Object(Q.jsxs)(Y.a,{basename:"/movies-search",children:[Object(Q.jsx)(re,{}),Object(Q.jsx)(ye,{})]})})};o.a.render(Object(Q.jsx)(Ee,{}),document.getElementById("app"))}},[[66,1,2]]]);
//# sourceMappingURL=main.4aef990b.chunk.js.map